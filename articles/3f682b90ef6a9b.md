---
title: "GitHub Actionsã§ãƒ†ã‚¹ãƒˆçµæœã‚’å¯è¦–åŒ–ã™ã‚‹"
emoji: "ğŸ“Š"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["Jest", "Playwright", "GithubActions"]
published: false
---

# GitHub Actions

GitHub ã®[ãƒãƒ¼ã‚±ãƒƒãƒˆãƒ—ãƒ¬ã‚¤ã‚¹](https://github.com/marketplace?category=&query=&type=actions&verification=)ã«ã¯ã€ãŸãã•ã‚“ã®ä¾¿åˆ©ãª`actions`ãŒé…å¸ƒã•ã‚Œã¦ã„ã¾ã™ã€‚ãã®ä¸­ã§ã‚‚ã€CI ã§ã®ãƒ†ã‚¹ãƒˆçµæœã‚’è‡ªå‹•ã§ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«ã‚³ãƒ¡ãƒ³ãƒˆã™ã‚‹ actions ã‚’ã„ãã¤ã‹è©¦ã—ã¦ã¿ã¾ã—ãŸã€‚

<!-- Jest ã®ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ¬ãƒãƒ¼ãƒˆã‚„ Playwright ã®çµæœãªã©ã‚’ã€ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã§ç¢ºèªã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ -->

## [jest-coverage-report-action](https://github.com/ArtiomTr/jest-coverage-report-action)

Jest ã®ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ¬ãƒãƒ¼ãƒˆã‚’ã‚³ãƒ¡ãƒ³ãƒˆã™ã‚‹ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã§ã™ã€‚PR ã”ã¨ã«ã‚«ãƒãƒ¬ãƒƒã‚¸ãŒç¢ºèªã§ãã‚‹ã®ã§è‡ªä¿¡ã‚’æŒã£ã¦ä½œæ¥­ã‚’é€²ã‚ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

```yml:.github/workflow/coverage.yml
steps:
  - name: Jest coverage report
    uses: ArtiomTr/jest-coverage-report-action@v2
    with:
      github-token: ${{ secrets.GITHUB_TOKEN }}
      package-manager: yarn
      test-script: npx jest
```

ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã¨ã€ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ¬ãƒãƒ¼ãƒˆãŒè‡ªå‹•ã§ã‚³ãƒ¡ãƒ³ãƒˆã•ã‚Œã¾ã™ã€‚

![](/images/3f682b90ef6a9b/2023-04-07-15-47-23.png)

# [upload-artifact@v3](https://github.com/actions/upload-artifact)

`artifacts`ã¯ã€ã‚¸ãƒ§ãƒ–ãŒå®Œäº†ã—ãŸå¾Œã«ãƒ‡ãƒ¼ã‚¿ã‚’ä¿æŒã—ã€åŒã˜ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å†…ã®åˆ¥ã®ã‚¸ãƒ§ãƒ–ã§ãã®ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
`upload-artifact`ã‚’ç”¨ã„ã¦`Playwright`ã®ãƒ¬ãƒãƒ¼ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’ç”Ÿæˆã—ã€æ¬¡ã®`Action`ã§ã‚ã‚‹`pull-request-artifacts`ã¸ã¨`artifacts`ãƒ‡ãƒ¼ã‚¿ã‚’å…±æœ‰ã—ã¾ã™ã€‚

```yml:.github/workflow/playwright.yml
- name: Install Playwright Browsers
  run: yarn playwright install --with-deps
- name: Run Playwright tests
  run: yarn e2e:all
- uses: actions/upload-artifact@v3
  if: always()
  with:
    name: playwright-report
    path: playwright-report/
    retention-days: 7
```

å®Ÿè¡Œã•ã‚ŒãŸã‚¢ã‚¯ã‚·ãƒ§ãƒ³æ¦‚è¦ã«`Artifacts`ã®é …ç›®ãŒã‚ã‚‹ã®ã§ã€ãã“ã‹ã‚‰æˆæœç‰©ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
![](/images/3f682b90ef6a9b/2023-04-07-18-30-24.png)

zip ãƒ•ã‚¡ã‚¤ãƒ«ã«ãªã£ã¦ã„ã‚‹ã®ã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰&è§£å‡ã™ã‚‹ã¨ã€ãƒ¬ãƒãƒ¼ãƒˆçµæœã®`html`ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¢ºèªã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
![](/images/3f682b90ef6a9b/2023-04-07-17-04-03.png)

### artifacts ç¢ºèªæ™‚ã®å•é¡Œç‚¹

ãƒ¬ãƒãƒ¼ãƒˆçµæœã®`html`ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¢ºèªã—ãŸã„ã ã‘ã«ã‚‚ã‹ã‹ã‚ã‚‰ãšã€

- `Actions` ãƒšãƒ¼ã‚¸ã«è¡Œã
- è©²å½“ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’æ¢ã™
- Artifacts ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‹ã‚‰ zip ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
- è§£å‡

ä¸Šè¨˜æ‰‹é †ã‚’è¸ã¾ãªã‘ã‚Œã°ãƒ¬ãƒãƒ¼ãƒˆã®`html`ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¢ºèªã™ã‚‹ã“ã¨ãŒã§ãã¾ã›ã‚“ã€‚
æ¬¡ã«ç´¹ä»‹ã™ã‚‹`pull-request-artifacts`ã‚’ç”¨ã„ã‚‹ã“ã¨ã§ã€ãã®ç…©é›‘ãªæ‰‹é †ã‚’ãªãã™ã“ã¨ãŒã§ãã¾ã™ã€‚

# [pull-request-artifacts](https://github.com/gavv/pull-request-artifacts)

`upload-artifact`ã§ç”Ÿæˆã—ãŸ`artifacts`ãƒ‡ãƒ¼ã‚¿ã‚’ PR ã‚³ãƒ¡ãƒ³ãƒˆã«å«ã‚ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

```yml:.github/workflow/playwright.yml
- name: Pull request artifacts
  if: ${{ github.event_name == 'pull_request' }}
  uses: gavv/pull-request-artifacts@v1.0.0
  with:
    commit: ${{ github.event.pull_request.head.sha }}
    repo-token: ${{ secrets.GITHUB_TOKEN }}
    # PRã‚³ãƒ¡ãƒ³ãƒˆã™ã‚‹ãƒ–ãƒ©ãƒ³ãƒ
    artifacts-branch: main
    # artifactsã®ãƒ‘ã‚¹
    artifacts: |
      playwright-report/index.html
```

`artifacts`ãƒ‡ãƒ¼ã‚¿ã®`html`ãƒ‡ãƒ¼ã‚¿ã‚’è‡ªå‹•ã‚³ãƒ¡ãƒ³ãƒˆã™ã‚‹ã“ã¨ã§ã€ç…©é›‘ã ã£ãŸæ‰‹é †ã‚’çœç•¥ã—ã€ç°¡å˜ã«ãƒ¬ãƒãƒ¼ãƒˆçµæœã‚’ç¢ºèªã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
![](/images/3f682b90ef6a9b/2023-04-07-16-24-22.png)
